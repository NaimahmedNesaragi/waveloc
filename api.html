<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>WaveLoc API &mdash; waveloc 0.2.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="waveloc 0.2.1 documentation" href="index.html" />
    <link rel="prev" title="Getting Started" href="getting_started.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="getting_started.html" title="Getting Started"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">waveloc 0.2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="waveloc-api">
<h1>WaveLoc API<a class="headerlink" href="#waveloc-api" title="Permalink to this headline">¶</a></h1>
<p>This page contains the documentation on each of the modules / classes /
functions that make up the waveloc package. The modules are ordered by subject
type. This is documentation is automatically generated from the doc-strings in
the code itself. It is meant as an aide to developpers or advanced users who
need access to the intrigacies of the code. It is not a tutorial (one will be
coming soon).</p>
<div class="section" id="travel-times">
<h2>TRAVEL-TIMES<a class="headerlink" href="#travel-times" title="Permalink to this headline">¶</a></h2>
<p>Waveloc needs travel-times to migrate the kurtosis waveforms. These can in
principle be obtained in many different ways. For simple Earth models, a
convenient way to obtain travel-time grids is to take advantage of the
<a class="reference external" href="http://alomax.free.fr/nlloc/">NonLinLoc</a> implementation of the eikonal
solver of Podvin &amp; Lecomte (1991).</p>
<div class="section" id="module-NllGridLib">
<span id="nllgridlib"></span><h3>NllGridLib<a class="headerlink" href="#module-NllGridLib" title="Permalink to this headline">¶</a></h3>
<p>The NllGridLib module contains functions to read the output of NonLinLoc (NLL)
in order to use the travel-times within waveloc.
Contributed by Alessia Maggi</p>
<dl class="function">
<dt id="NllGridLib.latlon2rect">
<tt class="descclassname">NllGridLib.</tt><tt class="descname">latlon2rect</tt><big>(</big><em>proj_name</em>, <em>lat</em>, <em>lon</em>, <em>proj_info={}</em><big>)</big><a class="reference internal" href="_modules/NllGridLib.html#latlon2rect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#NllGridLib.latlon2rect" title="Permalink to this definition">¶</a></dt>
<dd><p>Projects latitude and longitude coordinates into an x-y coordinate system.
Takes the projection from the NLL header info as read by <em>read_hdr_file</em>.
The inverse projection is provided by <em>rect2latlon</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>proj_name</strong> (<em>string</em>) &#8211; &#8216;TRANS_GLOBAL&#8217; | &#8216;TRANS_NONE&#8217; | &#8216;TRANS_SIMPLE&#8217; Only these
projection types are supported.</li>
<li><strong>lat</strong> (<em>float</em>) &#8211; Latitude in decimal degrees (positive = North, negative =
South)</li>
<li><strong>lon</strong> (<em>float</em>) &#8211; Longitude in decimal degrees (positive = East, negative = West)</li>
<li><strong>proj_info</strong> (<em>dictionary, optional</em>) &#8211; NLL header info as read by <em>read_hdr_file</em>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Raises UserWarning:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first">if unsupported projection type is encountered.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">tuple of floats</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">x and y coordinates in km wrt the origin of the projection</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="NllGridLib.qd_read_hyp_file">
<tt class="descclassname">NllGridLib.</tt><tt class="descname">qd_read_hyp_file</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/NllGridLib.html#qd_read_hyp_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#NllGridLib.qd_read_hyp_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick and dirty routine to read a NLL hypocenter file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>string</em>) &#8211; File to read</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple of floats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(otime, hypo_x, sigma_x, hypo_y, sigma_y, hypo_z, sigma_z)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="NllGridLib.qd_read_picks_from_hyp_file">
<tt class="descclassname">NllGridLib.</tt><tt class="descname">qd_read_picks_from_hyp_file</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/NllGridLib.html#qd_read_picks_from_hyp_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#NllGridLib.qd_read_picks_from_hyp_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick and dirty routine to read P-wave picks from NLL hypocenter file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>string</em>) &#8211; File to read</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dictionary</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A dictionary where the keys are the station names and the values
are the P-arrival times as UTCDateTime objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="NllGridLib.read_hdr_file">
<tt class="descclassname">NllGridLib.</tt><tt class="descname">read_hdr_file</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/NllGridLib.html#read_hdr_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#NllGridLib.read_hdr_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a NLL .hdr file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>string</em>) &#8211; File to read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Dictionary containing the information in the file. If filename is
a grid geometry header, the second line will be the projection info. If
filename is a travel-time grid header, there will also be a line with
the station information. The dictionary keys for the geometry are
&#8216;nx&#8217;, &#8216;ny&#8217;, &#8216;nz&#8217;, &#8216;x_orig&#8217;, &#8216;y_orig&#8217;, &#8216;z_orig&#8217;; those for the
projection are &#8216;proj_name&#8217;, &#8216;orig_lat&#8217;, &#8216;orig_lon&#8217;, &#8216;map_rot&#8217;; those
for the station information are &#8216;station&#8217;, &#8216;sta_x&#8217;, &#8216;sta_y&#8217;, &#8216;sta_z&#8217;.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="NllGridLib.read_stations_file">
<tt class="descclassname">NllGridLib.</tt><tt class="descname">read_stations_file</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/NllGridLib.html#read_stations_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#NllGridLib.read_stations_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a file formatted according the the NLL station format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>string</em>) &#8211; File to be read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Dictionary of stations. Each station is itself a dictionary
containing the following information: &#8216;station&#8217; = station name;
&#8216;loc_type&#8217; = [&#8216;XYZ&#8217; | &#8216;LATLON&#8217;]; if &#8216;loc_type&#8217; = &#8216;XYZ&#8217;, then the
coordinates of the station are given by &#8216;x&#8217; and &#8216;y&#8217;, otherwise they
are &#8216;lat&#8217;, &#8216;lon&#8217;; the depth and elevation of the station are given
respectively by &#8216;depth&#8217; and &#8216;elevation&#8217;.</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Raises UserWarning:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">if unknown &#8216;loc_type&#8217; encoutered.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="NllGridLib.rect2latlon">
<tt class="descclassname">NllGridLib.</tt><tt class="descname">rect2latlon</tt><big>(</big><em>proj_name</em>, <em>x</em>, <em>y</em>, <em>proj_info={}</em><big>)</big><a class="reference internal" href="_modules/NllGridLib.html#rect2latlon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#NllGridLib.rect2latlon" title="Permalink to this definition">¶</a></dt>
<dd><p>Projects x and y coordinates into an latitude-longitude coordinate system.
Takes the projection from the NLL header info as read by <em>read_hdr_file</em>.
The inverse projection is provided by <em>latlon2rect</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>proj_name</strong> (<em>string</em>) &#8211; &#8216;TRANS_GLOBAL&#8217; | &#8216;TRANS_NONE&#8217; | &#8216;TRANS_SIMPLE&#8217; Only these
projection types are supported.</li>
<li><strong>x</strong> (<em>float</em>) &#8211; x-coordinate in km wrt to the origin of the projection</li>
<li><strong>y</strong> (<em>float</em>) &#8211; y-coordinate in km wrt to the origin of the projection</li>
<li><strong>proj_info</strong> (<em>dictionary, optional</em>) &#8211; NLL header info as read by <em>read_hdr_file</em>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Raises UserWarning:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first">if unsupported projection type is encountered.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">tuple of floats</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">latitude and longitude (latitude positive North, longitude
positive East)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="hdf5-grids">
<h3>hdf5_grids<a class="headerlink" href="#hdf5-grids" title="Permalink to this headline">¶</a></h3>
<p>Waveloc manipulates many large arrays, some of which are written / read from
disk. On some machines, these arrays are larger than the available RAM. In
order to avoid the drammatic slow-downs when swapping to disc occurs in these
cases, we use hdf (hierarchical data formats) that provide memory-like access
to files on disc.</p>
<p>All large arrays that are infrequently accessed (e.g. travel-time arrays) are
written and used in this manner. When there is sufficient RAM available, large
arrays that are frequently accessed (search-point travel-times, 4D-migration
grids) are kept in memory.</p>
<span class="target" id="module-hdf5_grids"></span><dl class="class">
<dt id="hdf5_grids.H5NllSingleGrid">
<em class="property">class </em><tt class="descclassname">hdf5_grids.</tt><tt class="descname">H5NllSingleGrid</tt><big>(</big><em>filename</em>, <em>nll_filename</em><big>)</big><a class="reference internal" href="_modules/hdf5_grids.html#H5NllSingleGrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hdf5_grids.H5NllSingleGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Class derived from H5SingleGrid that upon initialization reads a NLL pair
of files (.hdr and .buf) and writes an equivalent hdf5 file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nll_name</strong> &#8211; NLL filename without extension</li>
<li><strong>h5_name</strong> &#8211; hdf5 filename</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="hdf5_grids.H5SingleGrid">
<em class="property">class </em><tt class="descclassname">hdf5_grids.</tt><tt class="descname">H5SingleGrid</tt><big>(</big><em>filename=None</em>, <em>grid_data=None</em>, <em>grid_info=None</em><big>)</big><a class="reference internal" href="_modules/hdf5_grids.html#H5SingleGrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hdf5_grids.H5SingleGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that wraps several methods for regular grids in HDF5 format.</p>
<p><strong>Attributes</strong></p>
<dl class="attribute">
<dt id="hdf5_grids.H5SingleGrid.grid_data">
<tt class="descname">grid_data</tt><a class="headerlink" href="#hdf5_grids.H5SingleGrid.grid_data" title="Permalink to this definition">¶</a></dt>
<dd><p>An HDF5 dataset.</p>
</dd></dl>

<dl class="attribute">
<dt id="hdf5_grids.H5SingleGrid.grid_info">
<tt class="descname">grid_info</tt><a class="headerlink" href="#hdf5_grids.H5SingleGrid.grid_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Attributes of an HDF5 dataset.</p>
</dd></dl>

<p><strong>Methods</strong></p>
<dl class="method">
<dt id="hdf5_grids.H5SingleGrid.interp_to_newgrid">
<tt class="descname">interp_to_newgrid</tt><big>(</big><em>new_filename</em>, <em>new_grid_info</em><big>)</big><a class="reference internal" href="_modules/hdf5_grids.html#H5SingleGrid.interp_to_newgrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hdf5_grids.H5SingleGrid.interp_to_newgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Intrepolates to a new grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>new_filename</strong> &#8211; Filename for new grid</li>
<li><strong>new_grid_info</strong> &#8211; Grid info dictionary for new grid</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hdf5_grids.H5SingleGrid.value_at_point">
<tt class="descname">value_at_point</tt><big>(</big><em>x</em>, <em>y</em>, <em>z</em>, <em>epsilon=0.001</em><big>)</big><a class="reference internal" href="_modules/hdf5_grids.html#H5SingleGrid.value_at_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hdf5_grids.H5SingleGrid.value_at_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs n-linear interpolation on the regular grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>float</em>) &#8211; x-coordinate of the point of interest</li>
<li><strong>y</strong> (<em>float</em>) &#8211; y-coordinate of the point of interest</li>
<li><strong>z</strong> (<em>float</em>) &#8211; z-coordinate of the point of interest</li>
<li><strong>epsilon</strong> (<em>float, optional</em>) &#8211; tollerance to edges of the grid</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">float</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">value at point</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="hdf5_grids.get_interpolated_time_grids">
<tt class="descclassname">hdf5_grids.</tt><tt class="descname">get_interpolated_time_grids</tt><big>(</big><em>opdict</em><big>)</big><a class="reference internal" href="_modules/hdf5_grids.html#get_interpolated_time_grids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hdf5_grids.get_interpolated_time_grids" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates the NLL time grids onto the search grids. Uses options
contained in a WavelocOptions.opdict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opdict</strong> &#8211; Dictionary of options in WavelocOptions.opdict format</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="hdf5_grids.nll2hdf5">
<tt class="descclassname">hdf5_grids.</tt><tt class="descname">nll2hdf5</tt><big>(</big><em>nll_name</em>, <em>h5_name</em><big>)</big><a class="reference internal" href="_modules/hdf5_grids.html#nll2hdf5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hdf5_grids.nll2hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Translates NLL files to hdf5 format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nll_name</strong> &#8211; NLL filename without extension</li>
<li><strong>h5_name</strong> &#8211; hdf5 filename</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="waveforms">
<h2>WAVEFORMS<a class="headerlink" href="#waveforms" title="Permalink to this headline">¶</a></h2>
<p>The waveform manipulation routines in waveloc are heavily based on
<a class="reference external" href="http://www.obspy.org">obspy</a>. As waveloc development started before obspy
was fully functionnal, some external functions are used where obspy equivalents
were not available. Updating all the waveform manipulation routines to use the
latest obspy features will be completed at some time.</p>
<div class="section" id="module-OP_waveforms">
<span id="op-waveform"></span><h3>OP_waveform<a class="headerlink" href="#module-OP_waveforms" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#module-OP_waveforms" title="OP_waveforms"><tt class="xref py py-mod docutils literal"><span class="pre">OP_waveforms</span></tt></a> module provides the <a class="reference internal" href="#OP_waveforms.Waveform" title="OP_waveforms.Waveform"><tt class="xref py py-class docutils literal"><span class="pre">Waveform</span></tt></a> class through
which most time-series manipulation is carried out, as well as several
useful functions.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires <strong>scikits.samplerate</strong> for full functionality (on linux systems
install with <tt class="docutils literal"><span class="pre">easy_install</span> <span class="pre">scikits.samplerate</span></tt> after having installed the
<tt class="docutils literal"><span class="pre">libsamplerate0</span></tt> libraries using e.g. <tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">libsamplerate0</span></tt>).
<strong>scikits.samplerate</strong> is used to provide high-fidelity resampling when
standard decimation is not possible (e.g. to pass from 125Hz sampling to
100Hz sampling).</p>
</div>
<dl class="class">
<dt id="OP_waveforms.Waveform">
<em class="property">class </em><tt class="descclassname">OP_waveforms.</tt><tt class="descname">Waveform</tt><a class="reference internal" href="_modules/OP_waveforms.html#Waveform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper class for obspy streams. Adds many convenience functions, and
functionality specific to WaveLoc processing.</p>
<p><strong>Attributes</strong></p>
<dl class="attribute">
<dt id="OP_waveforms.Waveform.stream">
<tt class="descname">stream</tt><a class="headerlink" href="#OP_waveforms.Waveform.stream" title="Permalink to this definition">¶</a></dt>
<dd><p>An <tt class="xref py py-class docutils literal"><span class="pre">obspy.core.Stream</span></tt> object.  Can be accessed directly.
Initialises to <tt class="docutils literal"><span class="pre">None</span></tt>.
If you set this attribute directly, you should also set <a class="reference internal" href="#OP_waveforms.Waveform.trace" title="OP_waveforms.Waveform.trace"><tt class="xref py py-attr docutils literal"><span class="pre">trace</span></tt></a>
to <a class="reference internal" href="#OP_waveforms.Waveform.stream" title="OP_waveforms.Waveform.stream"><tt class="xref py py-attr docutils literal"><span class="pre">stream</span></tt></a>.traces[0]</p>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.trace">
<tt class="descname">trace</tt><a class="headerlink" href="#OP_waveforms.Waveform.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>An obspy.Trace object.  Can be accessed directly.
Initialises to <tt class="docutils literal"><span class="pre">None</span></tt>.
If you set this directly, make sure it points to
<a class="reference internal" href="#OP_waveforms.Waveform.stream" title="OP_waveforms.Waveform.stream"><tt class="xref py py-attr docutils literal"><span class="pre">stream</span></tt></a>.traces[0]</p>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.proc">
<tt class="descname">proc</tt><a class="headerlink" href="#OP_waveforms.Waveform.proc" title="Permalink to this definition">¶</a></dt>
<dd><p>Text string indicating processing type.  Can be accessed directly.
Initialises to <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>

<p><strong>Methods</strong></p>
<dl class="method">
<dt id="OP_waveforms.Waveform.bp_filter">
<tt class="descname">bp_filter</tt><big>(</big><em>freqmin</em>, <em>freqmax</em>, <em>zerophase=False</em>, <em>rmean=False</em>, <em>taper=False</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.bp_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.bp_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a band-pass filter to the data.  If data are segmented into
multiple traces, apply the same filter to all traces.  Calls
<tt class="xref py py-func docutils literal"><span class="pre">obspy.signal.filter()</span></tt> to do the filtering.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>freqmin</strong> (<em>float</em>) &#8211; Low frequency corner</li>
<li><strong>freqmax</strong> (<em>float</em>) &#8211; High frequency corner</li>
<li><strong>zerophase</strong> (<em>bool</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> applies a non-causal bandpass filter.  If
<tt class="docutils literal"><span class="pre">False</span></tt> applies a causal bandpass filter.</li>
<li><strong>rmean</strong> (<em>bool</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> remove mean before filtering.</li>
<li><strong>taper</strong> (<em>bool</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> apply taper before filtering.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Raises UserWarning:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first last">if no data in stream.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.channel">
<tt class="descname">channel</tt><a class="headerlink" href="#OP_waveforms.Waveform.channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Channel name from <tt class="docutils literal"><span class="pre">self.trace</span></tt> (read-only).</p>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.comp">
<tt class="descname">comp</tt><a class="headerlink" href="#OP_waveforms.Waveform.comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Channel name from <tt class="docutils literal"><span class="pre">self.trace</span></tt> (read-only).</p>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.compute_signature">
<tt class="descname">compute_signature</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.compute_signature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.compute_signature" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a signature for a waveform, made up by the maximum of the
trace and its sum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple of floats</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">maximum, datasum</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.decimate">
<tt class="descname">decimate</tt><big>(</big><em>factor=1</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.decimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.decimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies <tt class="docutils literal"><span class="pre">obspy</span></tt> decimation, after applying an anti-aliasing,
non-causal filter of 0.4*(new sample rate).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>factor</strong> (<em>integer</em>) &#8211; Decimation factor.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.delta">
<tt class="descname">delta</tt><a class="headerlink" href="#OP_waveforms.Waveform.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Time step between data points in <a class="reference internal" href="#OP_waveforms.Waveform.trace" title="OP_waveforms.Waveform.trace"><tt class="xref py py-attr docutils literal"><span class="pre">trace</span></tt></a> (read-only).</p>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.display">
<tt class="descname">display</tt><big>(</big><em>title=''</em>, <em>filename=''</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.display"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.display" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a quick and dirty plot of the waveform.
If filename is given (and is different from &#8220;&#8221;) then the plot of the
waveform is written to file, otherwise it is shown on the screen.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>title</strong> (<em>string</em>) &#8211; Title for the plot.</li>
<li><strong>filename</strong> (<em>string</em>) &#8211; Filename for the plot (format defined by the file
extension).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.dt">
<tt class="descname">dt</tt><a class="headerlink" href="#OP_waveforms.Waveform.dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Time step between data points in <a class="reference internal" href="#OP_waveforms.Waveform.trace" title="OP_waveforms.Waveform.trace"><tt class="xref py py-attr docutils literal"><span class="pre">trace</span></tt></a> (read-only).</p>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.get_snr">
<tt class="descname">get_snr</tt><big>(</big><em>o_time</em>, <em>left_time</em>, <em>right_time</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.get_snr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.get_snr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns signal-to-noise ratio, where signal = max(abs(signal between
left_time and right_time)) and noise = median(abs(signal between
left_time- and otime)).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>o_time</strong> (<em>UTCDateTime</em>) &#8211; center time for SNR calculation</li>
<li><strong>left_time</strong> (<em>UTCDateTime</em>) &#8211; left time for SNR calculation</li>
<li><strong>right_time</strong> (<em>UTCDateTime</em>) &#8211; right time for SNR calculation</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.npts">
<tt class="descname">npts</tt><a class="headerlink" href="#OP_waveforms.Waveform.npts" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points in <a class="reference internal" href="#OP_waveforms.Waveform.trace" title="OP_waveforms.Waveform.trace"><tt class="xref py py-attr docutils literal"><span class="pre">trace</span></tt></a> (read-only).</p>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.process_envelope">
<tt class="descname">process_envelope</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.process_envelope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.process_envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs envelope processing on a waveform. Replaces self.trace and sets
self.proc to &#8220;Envelope&#8217;.</p>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.process_gaussian">
<tt class="descname">process_gaussian</tt><big>(</big><em>threshold</em>, <em>mu=0.0</em>, <em>sigma=0.1</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.process_gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.process_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace local maxima by a series of dirac and convolve them with a
gaussian distribution. Overwrites the waveform. Sets self.proc to
&#8216;Gaussian&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>threshold</strong> (<em>float</em>) &#8211; value over which the convolution is applied</li>
<li><strong>mu</strong> (<em>float</em>) &#8211; expected value of the gaussian distribution</li>
<li><strong>sigma</strong> (<em>float</em>) &#8211; variance of the gaussian distribution</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.process_kurtosis">
<tt class="descname">process_kurtosis</tt><big>(</big><em>win</em>, <em>recursive=False</em>, <em>pre_rmean=False</em>, <em>pre_taper=False</em>, <em>post_taper=True</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.process_kurtosis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.process_kurtosis" title="Permalink to this definition">¶</a></dt>
<dd><p>Processing waveform using kurtosis (from statlib package).
Calls filters.sw_kurtosis1(), and overwrites the waveform.
Sets self.prof to &#8216;Kurtosis&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>win</strong> &#8211; length of the window (in seconds) on which to calculate the
kurtosis</li>
<li><strong>recursive</strong> (<em>boolean, optional</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> applies recursive kurtosis calculation</li>
<li><strong>pre_rmean</strong> (<em>boolean, optional</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> removes mean of signal before processing.</li>
<li><strong>pre_taper</strong> (<em>boolean, optional</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> applies taper to signal before
processing.</li>
<li><strong>post_taper</strong> (<em>boolean, optional</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> applies taper to signal after
processing.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.process_none">
<tt class="descname">process_none</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.process_none"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.process_none" title="Permalink to this definition">¶</a></dt>
<dd><p>No processing on a waveform.  Sets self.proc to &#8220;None&#8221;</p>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.process_sta_lta">
<tt class="descname">process_sta_lta</tt><big>(</big><em>stawin</em>, <em>ltawin</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.process_sta_lta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.process_sta_lta" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs classic short to long term average ratio processing on waveform.
Replaces self.trace and sets self.proc to StaLta.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stawin</strong> &#8211; length of the short term average window in seconds</li>
<li><strong>ltawin</strong> &#8211; length of the long term average window in seconds</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.read_from_SDS">
<tt class="descname">read_from_SDS</tt><big>(</big><em>sds_root</em>, <em>net_name</em>, <em>sta_name</em>, <em>comp_name</em>, <em>starttime=None</em>, <em>endtime=None</em>, <em>rmean=False</em>, <em>taper=False</em>, <em>pad_value=None</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.read_from_SDS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.read_from_SDS" title="Permalink to this definition">¶</a></dt>
<dd><p>Read waveform data from an SDS structured archive.  Simple overlaps and
adjacent traces are merged if possile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sds_root</strong> (<em>string</em>) &#8211; root of the SDS archive</li>
<li><strong>net_name</strong> (<em>string</em>) &#8211; network name</li>
<li><strong>sta_name</strong> (<em>string</em>) &#8211; station name</li>
<li><strong>comp_name</strong> (<em>string</em>) &#8211; component name</li>
<li><strong>starttime</strong> (<tt class="docutils literal"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></tt> object,
optional) &#8211; Start time of data to be read.</li>
<li><strong>endtime</strong> (<tt class="docutils literal"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></tt> object, optional) &#8211; End time of data to be read.</li>
<li><strong>rmean</strong> (<em>boolean, optional</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> removes the mean from the data upon reading.
If data are segmented, the mean will be removed from all segments
individually.</li>
<li><strong>taper</strong> (<em>boolean, optional</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> applies a cosine taper to the data upon
reading.  If data are segmented, tapers are applied to all segments
individually.</li>
<li><strong>pad_value</strong> (<em>float, optional</em>) &#8211; If this parameter is set, points between
<tt class="docutils literal"><span class="pre">starttime</span></tt> and the first point in the file, and points between
the last point in the file and <tt class="docutils literal"><span class="pre">endtime</span></tt>, will be set to
<tt class="docutils literal"><span class="pre">pad_value</span></tt>.  You may want to also use the <tt class="docutils literal"><span class="pre">rmean</span></tt> and
<tt class="docutils literal"><span class="pre">taper</span></tt> parameters, depending on the nature of the data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Raises UserWarning:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first last">If there are no data between <tt class="docutils literal"><span class="pre">starttime</span></tt> and
<tt class="docutils literal"><span class="pre">endtime</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.read_from_file">
<tt class="descname">read_from_file</tt><big>(</big><em>filename</em>, <em>format=None</em>, <em>starttime=None</em>, <em>endtime=None</em>, <em>rmean=False</em>, <em>taper=False</em>, <em>pad_value=None</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.read_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.read_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read waveform data from file.  Multiple traces are merged if they
overlap exactly or are adjacent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> &#8211; Waveform filename</li>
<li><strong>format</strong> (<em>string</em>) &#8211; <tt class="docutils literal"><span class="pre">obspy</span></tt> format type (e.g. &#8216;SAC&#8217;, &#8216;mseed&#8217;...)</li>
<li><strong>starttime</strong> (<tt class="docutils literal"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></tt> object) &#8211; Start time of data to be read.</li>
<li><strong>endtime</strong> (<tt class="docutils literal"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></tt> object) &#8211; End time of data to be read.</li>
<li><strong>rmean</strong> (<em>boolean</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> removes the mean from the data upon reading.
If data are segmented, the mean will be removed from all segments
individually.</li>
<li><strong>taper</strong> (<em>boolean</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> applies a cosine taper to the data upon
reading.  If data are segmented, tapers are applied to all segments
individually.</li>
<li><strong>pad_value</strong> (<em>float</em>) &#8211; If this parameter is set, points between
<tt class="docutils literal"><span class="pre">starttime</span></tt> and the first point in the file, and points between
the last point in the file and <tt class="docutils literal"><span class="pre">endtime</span></tt>, will be set to
<tt class="docutils literal"><span class="pre">pad_value</span></tt>.  You may want to also use the <tt class="docutils literal"><span class="pre">rmean</span></tt> and
<tt class="docutils literal"><span class="pre">taper</span></tt> parameters, depending on the nature of the data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Raises UserWarning:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first last">If there are no data between <tt class="docutils literal"><span class="pre">starttime</span></tt> and
<tt class="docutils literal"><span class="pre">endtime</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.resample">
<tt class="descname">resample</tt><big>(</big><em>new_samplerate</em>, <em>resample_type='sinc_best'</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.resample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.resample" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies audio-quality resampling in place. Requires installation of
<tt class="docutils literal"><span class="pre">scikits.samplerate</span></tt>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>new_samplerate</strong> (<em>float</em>) &#8211; New sample rate.</li>
<li><strong>resample_type</strong> (<em>string</em>) &#8211; Can be <tt class="docutils literal"><span class="pre">'sinc_best'</span></tt>, ...</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.rmean">
<tt class="descname">rmean</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.rmean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.rmean" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the mean of the stream (iterates over all traces).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Raises UserWarning:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">if no data in stream.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.starttime">
<tt class="descname">starttime</tt><a class="headerlink" href="#OP_waveforms.Waveform.starttime" title="Permalink to this definition">¶</a></dt>
<dd><p>Start time of <tt class="docutils literal"><span class="pre">self.trace</span></tt> (read-only).</p>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.station">
<tt class="descname">station</tt><a class="headerlink" href="#OP_waveforms.Waveform.station" title="Permalink to this definition">¶</a></dt>
<dd><p>Station name from <tt class="docutils literal"><span class="pre">self.trace</span></tt> (read-only).</p>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.t_array">
<tt class="descname">t_array</tt><a class="headerlink" href="#OP_waveforms.Waveform.t_array" title="Permalink to this definition">¶</a></dt>
<dd><p>A <tt class="docutils literal"><span class="pre">numpy.array</span></tt> containing times in seconds from
<tt class="docutils literal"><span class="pre">self.trace.stats.starttime</span></tt> for data points in <tt class="docutils literal"><span class="pre">self.trace</span></tt>
(read-only).</p>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.take_positive_derivative">
<tt class="descname">take_positive_derivative</tt><big>(</big><em>pre_rmean=False</em>, <em>pre_taper=False</em>, <em>post_taper=True</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.take_positive_derivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.take_positive_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes positive derivative of a stream (used to calculate the positive
kurtosis gradient).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pre_mean</strong> &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> then remove the mean before taking
positive gradient</li>
<li><strong>pre_taper</strong> &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> then apply a taper before taking positive</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>gradient
:param post_taper: If <tt class="docutils literal"><span class="pre">True</span></tt> then apply a taper after taking positive
gradient.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Raises UserWarning:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">if no data in stream.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.taper">
<tt class="descname">taper</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.taper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.taper" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a cosine taper the stream (iterates over all traces).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Raises UserWarning:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">if no data in stream.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="OP_waveforms.Waveform.values">
<tt class="descname">values</tt><a class="headerlink" href="#OP_waveforms.Waveform.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Values of <tt class="docutils literal"><span class="pre">self.trace.data</span></tt> (read-only).</p>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.write_to_file">
<tt class="descname">write_to_file</tt><big>(</big><em>filename</em>, <em>format=None</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.write_to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.write_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write waveform to file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; Output filename.</li>
<li><strong>format</strong> (<em>string</em>) &#8211; <tt class="docutils literal"><span class="pre">obspy</span></tt> format type (e.g. &#8216;SAC&#8217;, &#8216;mseed&#8217;...)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="OP_waveforms.Waveform.write_to_file_filled">
<tt class="descname">write_to_file_filled</tt><big>(</big><em>filename</em>, <em>format=None</em>, <em>fill_value=0</em>, <em>rmean=False</em>, <em>taper=False</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#Waveform.write_to_file_filled"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.Waveform.write_to_file_filled" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Write waveform to file, after merging and filling blanks with</dt>
<dd><tt class="docutils literal"><span class="pre">fill_value</span></tt>.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; Output filename.</li>
<li><strong>format</strong> &#8211; <tt class="docutils literal"><span class="pre">obspy</span></tt> format type (e.g. &#8216;SAC&#8217;, &#8216;mseed&#8217;...)</li>
<li><strong>fill_value</strong> (<em>float, optional</em>) &#8211; Value used to fill in gaps</li>
<li><strong>rmean</strong> (<em>bool, optional</em>) &#8211; Remove the mean before merging.</li>
<li><strong>taper</strong> (<em>bool, optional</em>) &#8211; Apply taper before merging.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="OP_waveforms.compute_gauss">
<tt class="descclassname">OP_waveforms.</tt><tt class="descname">compute_gauss</tt><big>(</big><em>dt</em>, <em>mu</em>, <em>sig</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#compute_gauss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.compute_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a time-step, a mean and sigma, returns an array with a Gaussian
signal from -4*sigma to +4*sigma around the mean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>float</em>) &#8211; time-step in seconds</li>
<li><strong>mu</strong> (<em>float</em>) &#8211; mean of the Gaussian</li>
<li><strong>sig</strong> (<em>float</em>) &#8211; half-width sigma of the Gaussian</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">array with Gaussian signal</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="OP_waveforms.read_data_compatible_with_time_dict">
<tt class="descclassname">OP_waveforms.</tt><tt class="descname">read_data_compatible_with_time_dict</tt><big>(</big><em>filenames</em>, <em>time_dict</em>, <em>starttime</em>, <em>endtime</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#read_data_compatible_with_time_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.read_data_compatible_with_time_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads data that have the same station names as those used as keys to a
given time dictionary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>list of strings</em>) &#8211; list of filenames</li>
<li><strong>time_dict</strong> (<em>dictionary</em>) &#8211; dictionary indexed by station names</li>
<li><strong>starttime</strong> (<em>UTCDateTime</em>) &#8211; start-time to read data</li>
<li><strong>endtime</strong> (<em>UTCDateTime</em>) &#8211; end-time to read data</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Raises UserWarning:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first last">if sampling is different between the files</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="OP_waveforms.stream_positive_derivative">
<tt class="descclassname">OP_waveforms.</tt><tt class="descname">stream_positive_derivative</tt><big>(</big><em>st</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#stream_positive_derivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.stream_positive_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes first time derivative of a stream (iterates over all available
traces) and keep only positive values (set negative values to zero).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>st</strong> (<em>An obspy.stream object</em>) &#8211; Input stream, processed in place</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="OP_waveforms.stream_rmean">
<tt class="descclassname">OP_waveforms.</tt><tt class="descname">stream_rmean</tt><big>(</big><em>st</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#stream_rmean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.stream_rmean" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes mean from a stream (iterates over all available traces).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>st</strong> (<em>An obspy.stream object</em>) &#8211; Input stream, processed in place</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="OP_waveforms.stream_taper">
<tt class="descclassname">OP_waveforms.</tt><tt class="descname">stream_taper</tt><big>(</big><em>st</em><big>)</big><a class="reference internal" href="_modules/OP_waveforms.html#stream_taper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#OP_waveforms.stream_taper" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies cosine taper to a stream (iterates over all available traces).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>st</strong> (<em>An obspy.stream object</em>) &#8211; Input stream, processed in place</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-filters">
<span id="filters"></span><h3>filters<a class="headerlink" href="#module-filters" title="Permalink to this headline">¶</a></h3>
<p>Functions for timeseries filtering.</p>
<p>Created by Alessia Maggi and Alberto Michelini.</p>
<dl class="function">
<dt id="filters.allens_stalta">
<tt class="descclassname">filters.</tt><tt class="descname">allens_stalta</tt><big>(</big><em>x</em>, <em>dt</em>, <em>STAwin</em>, <em>LTAwin</em><big>)</big><a class="reference internal" href="_modules/filters.html#allens_stalta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.allens_stalta" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the short to long time average ratio of a timeseries.
using Allen (1978) caracteristic function (see report)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>dt</strong> &#8211; sampling interval</li>
<li><strong>dt</strong> &#8211; sampling interval in seconds.</li>
<li><strong>STAwin</strong> &#8211; short time average window in seconds.</li>
<li><strong>LTAwin</strong> &#8211; long time average in seconds.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">processed signal</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.envelope">
<tt class="descclassname">filters.</tt><tt class="descname">envelope</tt><big>(</big><em>x</em>, <em>N</em><big>)</big><a class="reference internal" href="_modules/filters.html#envelope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the envelope of a signal using the Hilbert transform.
Uses scipy.signal.hilbert() to do the Hilbert transform.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>N</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">envelope as numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.filtfilt">
<tt class="descclassname">filters.</tt><tt class="descname">filtfilt</tt><big>(</big><em>b</em>, <em>a</em>, <em>x</em><big>)</big><a class="reference internal" href="_modules/filters.html#filtfilt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.filtfilt" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO What does this function do?  Alberto??</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>b</strong> &#8211; </li>
<li><strong>a</strong> &#8211; </li>
<li><strong>x</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Raises ValueError:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.gradient">
<tt class="descclassname">filters.</tt><tt class="descname">gradient</tt><big>(</big><em>x</em>, <em>dt</em>, <em>LENwin</em><big>)</big><a class="reference internal" href="_modules/filters.html#gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the gradient of a timeseries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>dt</strong> &#8211; sampling interval in seconds.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">LENwin:</th><td class="field-body"><p class="first last">time window (in secs) over which the gradient is determined</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.kurto">
<tt class="descclassname">filters.</tt><tt class="descname">kurto</tt><big>(</big><em>x</em>, <em>dt</em>, <em>LENwin</em><big>)</big><a class="reference internal" href="_modules/filters.html#kurto"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.kurto" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the kurtosis of a timeseries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>dt</strong> &#8211; sampling interval in seconds.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">LENwin:</th><td class="field-body"><p class="first last">time window (in secs) over which the kurtosis is determined</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.kurto_improved">
<tt class="descclassname">filters.</tt><tt class="descname">kurto_improved</tt><big>(</big><em>x</em>, <em>dt</em>, <em>LENwin</em><big>)</big><a class="reference internal" href="_modules/filters.html#kurto_improved"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.kurto_improved" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the kurtosis of a timeseries as described by kuperkoch et al.
2010: calculate the kurtosis recursively.
Results are not satisfying, but one may want to improve this... it might
save some time!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>dt</strong> &#8211; sampling interval in seconds.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">LENwin:</th><td class="field-body"><p class="first last">time window (in secs) over which the kurtosis is determined</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.lfilter_zi">
<tt class="descclassname">filters.</tt><tt class="descname">lfilter_zi</tt><big>(</big><em>b</em>, <em>a</em><big>)</big><a class="reference internal" href="_modules/filters.html#lfilter_zi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.lfilter_zi" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the zi state from the filter parameters. See [Gust96].</p>
<p>Based on:
[Gust96] Fredrik Gustafsson, Determining the initial states in
forward-backward filtering, IEEE Transactions on Signal Processing, pp.
988&#8211;992, April 1996, Volume 44, Issue 4</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>b</strong> &#8211; </li>
<li><strong>a</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">zi state as numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.projection">
<tt class="descclassname">filters.</tt><tt class="descname">projection</tt><big>(</big><em>x</em>, <em>y</em>, <em>theta</em><big>)</big><a class="reference internal" href="_modules/filters.html#projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Project x and y onto a line of angle theta.</p>
</dd></dl>

<dl class="function">
<dt id="filters.rec_dx2">
<tt class="descclassname">filters.</tt><tt class="descname">rec_dx2</tt><big>(</big><em>x</em>, <em>C1</em><big>)</big><a class="reference internal" href="_modules/filters.html#rec_dx2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.rec_dx2" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive dx2 (from Chassande-Mottin, 2002)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>C</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">processed signal as numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.rec_kurtosis">
<tt class="descclassname">filters.</tt><tt class="descname">rec_kurtosis</tt><big>(</big><em>x</em>, <em>C1</em><big>)</big><a class="reference internal" href="_modules/filters.html#rec_kurtosis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.rec_kurtosis" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive Kurtosis calculated using Chassande-Mottin (2002). Beware, this
function is unstable for strongly non-stationary signals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>C</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">processed signal as numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.rec_kurtosis_old">
<tt class="descclassname">filters.</tt><tt class="descname">rec_kurtosis_old</tt><big>(</big><em>x</em>, <em>C</em><big>)</big><a class="reference internal" href="_modules/filters.html#rec_kurtosis_old"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.rec_kurtosis_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive pseudo-kurtosis calculation as used by Langet et al. (2014)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>C</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">procesed signal as numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.skewness">
<tt class="descclassname">filters.</tt><tt class="descname">skewness</tt><big>(</big><em>x</em>, <em>dt</em>, <em>LENwin</em><big>)</big><a class="reference internal" href="_modules/filters.html#skewness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.skewness" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the absolute value of the skewness of a timeseries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>dt</strong> &#8211; sampling interval in seconds.</li>
<li><strong>LENwin</strong> &#8211; time window (in secs) over which the skewness is determined</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.smooth">
<tt class="descclassname">filters.</tt><tt class="descname">smooth</tt><big>(</big><em>x</em>, <em>window_len=11</em>, <em>window='hanning'</em><big>)</big><a class="reference internal" href="_modules/filters.html#smooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the begining and end part of the output signal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; the input signal</li>
<li><strong>window_len</strong> &#8211; the dimension of the smoothing window; should be an odd
integer</li>
<li><strong>window</strong> &#8211; the type of window from &#8216;flat&#8217;, &#8216;hanning&#8217;, &#8216;hamming&#8217;,
&#8216;bartlett&#8217;, &#8216;blackman&#8217;. Flat window will produce a moving average
smoothing.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the smoothed signal</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Raises ValueError:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
<p>example:</p>
<p>t=linspace(-2,2,0.1)
x=sin(t)+randn(len(t))*0.1
y=smooth(x)</p>
<dl class="docutils">
<dt>see also: numpy.hanning, numpy.hamming, numpy.bartlett, numpy.blackman,</dt>
<dd>numpy.convolve scipy.signal.lfilter</dd>
<dt>TODO: the window parameter could be the window itself if an array instead</dt>
<dd>of a string</dd>
<dt>NOTE: length(output) != length(input), to correct this: return</dt>
<dd>y[(window_len/2-1):-(window_len/2)] instead of just y.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="filters.stalta">
<tt class="descclassname">filters.</tt><tt class="descname">stalta</tt><big>(</big><em>x</em>, <em>dt</em>, <em>STAwin</em>, <em>LTAwin</em><big>)</big><a class="reference internal" href="_modules/filters.html#stalta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.stalta" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the short to long time average ratio of a timeseries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>dt</strong> &#8211; sampling interval in seconds.</li>
<li><strong>STAwin</strong> &#8211; short time average window in seconds.</li>
<li><strong>LTAwin</strong> &#8211; long time average in seconds.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">processed signal</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.sw_kurtosis1">
<tt class="descclassname">filters.</tt><tt class="descname">sw_kurtosis1</tt><big>(</big><em>x</em>, <em>n</em><big>)</big><a class="reference internal" href="_modules/filters.html#sw_kurtosis1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.sw_kurtosis1" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns kurtosis calculated over data set x using sliding windows of length
n points.  Length of returned array is len(x)-n+1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>n</strong> &#8211; length of sliding window in points</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">procesed signal as numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.sw_kurtosis2">
<tt class="descclassname">filters.</tt><tt class="descname">sw_kurtosis2</tt><big>(</big><em>x</em>, <em>n</em><big>)</big><a class="reference internal" href="_modules/filters.html#sw_kurtosis2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.sw_kurtosis2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns kurtosis calculated over data set x using sliding windows of length
n points.  Length of returned array is len(x)-n+1.
This version uses filter.window() to slice the data array and is faster
than sw_kurtosis1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>n</strong> &#8211; length of sliding window in points</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">procesed signal as numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.variance">
<tt class="descclassname">filters.</tt><tt class="descname">variance</tt><big>(</big><em>x</em>, <em>dt</em>, <em>LENwin</em><big>)</big><a class="reference internal" href="_modules/filters.html#variance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the variance of a timeseries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>dt</strong> &#8211; sampling interval in seconds.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">LENwin:</th><td class="field-body"><p class="first">time window (in secs) over which the variance is determined</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">processed signal as numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.variance_under_rotation">
<tt class="descclassname">filters.</tt><tt class="descname">variance_under_rotation</tt><big>(</big><em>x</em>, <em>y</em>, <em>dt</em>, <em>LENwin</em><big>)</big><a class="reference internal" href="_modules/filters.html#variance_under_rotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.variance_under_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the variance under rotation of a timeseries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>dt</strong> &#8211; sampling interval in seconds.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">LENwin:</th><td class="field-body"><p class="first last">time window (in secs) over which the variance under rotation is
determined</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="filters.varrot">
<tt class="descclassname">filters.</tt><tt class="descname">varrot</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="reference internal" href="_modules/filters.html#varrot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.varrot" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : figure out what this function actually does !!</p>
</dd></dl>

<dl class="function">
<dt id="filters.window">
<tt class="descclassname">filters.</tt><tt class="descname">window</tt><big>(</big><em>seq</em>, <em>n=2</em><big>)</big><a class="reference internal" href="_modules/filters.html#window"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#filters.window" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Returns a sliding window (of width n) over data from the iterable</dt>
<dd>s -&gt; (s0,s1,...s[n-1]), (s1,s2,...,sn), ...</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>seq</strong> &#8211; an iterable sequence</li>
<li><strong>n</strong> &#8211; length of window (number of elements)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-kurtogram">
<span id="kurtogram"></span><h3>kurtogram<a class="headerlink" href="#module-kurtogram" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="kurtogram.DBFB">
<tt class="descclassname">kurtogram.</tt><tt class="descname">DBFB</tt><big>(</big><em>x</em>, <em>h</em>, <em>g</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#DBFB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.DBFB" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Double-band filter-bank.</dt>
<dd>[a,d] = DBFB(x,h,g) computes the approximation
coefficients vector a and detail coefficients vector d,
obtained by passing signal x though a two-band analysis filter-bank.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>h</strong> &#8211; The decomposition low-pass filter and</li>
<li><strong>g</strong> &#8211; The decomposition high-pass filter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a, d</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.Fast_Kurtogram">
<tt class="descclassname">kurtogram.</tt><tt class="descname">Fast_Kurtogram</tt><big>(</big><em>x</em>, <em>nlevel</em>, <em>verbose=False</em>, <em>Fs=1</em>, <em>NFIR=16</em>, <em>fcut=0.4</em>, <em>opt1=1</em>, <em>opt2=1</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#Fast_Kurtogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.Fast_Kurtogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the fast kurtogram of signal x up to level &#8216;nlevel&#8217;
Maximum number of decomposition levels is log2(length(x)), but it is
recommended to stay by a factor 1/8 below this.</p>
<p>J. Antoni : 02/2005
Translation to Python: T. Lecocq 02/2012</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal to analyse</li>
<li><strong>nlevel</strong> &#8211; number of decomposition levels</li>
<li><strong>verbose</strong> &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> outputs debugging information</li>
<li><strong>Fs</strong> &#8211; Sampling frequency of signal x</li>
<li><strong>NFIR</strong> &#8211; Length of FIR filter</li>
<li><strong>fcut</strong> &#8211; Fraction of Nyquist for filter</li>
<li><strong>opt1</strong> &#8211; [1 | 2]:
* opt1=1: classical kurtosis based on 4th order statistics
* opt1 = 2: robust kurtosis based on 2nd order statistics of the
envelope (if there is any difference in the kurtogram between the
two measures, this is  due to the presence of impulsive additive
noise)</li>
<li><strong>opt2</strong> &#8211; [1 | 2]:
* opt2=1: the kurtogram is computed via a fast decimated filterbank
* opt2=2: the kurtogram is computed via the short-time Fourier
transform (option 1 is faster and has more flexibility than option
2 in the design of the analysis filter: a short filter in option 1
gives virtually the same results as option 2)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Kwav, Level_w, freq_w, c, f_lower, f_upper</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.Find_wav_kurt">
<tt class="descclassname">kurtogram.</tt><tt class="descname">Find_wav_kurt</tt><big>(</big><em>x</em>, <em>h</em>, <em>g</em>, <em>h1</em>, <em>h2</em>, <em>h3</em>, <em>nlevel</em>, <em>Sc</em>, <em>Fr</em>, <em>Fs=1</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#Find_wav_kurt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.Find_wav_kurt" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO flesh out this doc-string</p>
<p>J. Antoni : 12/2004
Translation to Python: T. Lecocq 02/2012</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>h</strong> &#8211; lowpass filter</li>
<li><strong>g</strong> &#8211; higpass filter</li>
<li><strong>h1</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>h2</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>h3</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>nlevel</strong> &#8211; number of decomposition levels</li>
<li><strong>Sc</strong> &#8211; Sc = -log2(Bw)-1 with Bw the bandwidth of the filter</li>
<li><strong>Fr</strong> &#8211; in the range [0, 0.5]</li>
<li><strong>Fs</strong> &#8211; Sampling frequency of signal x</li>
<li><strong>verbose</strong> &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> outputs debugging information</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.K_wpQ">
<tt class="descclassname">kurtogram.</tt><tt class="descname">K_wpQ</tt><big>(</big><em>x</em>, <em>h</em>, <em>g</em>, <em>h1</em>, <em>h2</em>, <em>h3</em>, <em>nlevel</em>, <em>verbose</em>, <em>opt</em>, <em>level=0</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#K_wpQ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.K_wpQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the kurtosis K of the complete quinte wavelet packet transform w
of signal x, up to nlevel, using the lowpass and highpass filters h and g,
respectively.  The WP coefficients are sorted according to the frequency
decomposition.  This version handles both real and analytical filters, but
does not yield WP coefficients suitable for signal synthesis.</p>
<p>J. Antoni : 12/2004
Translation to Python: T. Lecocq 02/2012</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>h</strong> &#8211; lowpass filter</li>
<li><strong>g</strong> &#8211; higpass filter</li>
<li><strong>h1</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>h2</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>h3</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>nlevel</strong> &#8211; number of decomposition levels</li>
<li><strong>verbose</strong> &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> outputs debugging information</li>
<li><strong>opt</strong> &#8211; [&#8216;kurt1&#8217; | &#8216;kurt2&#8217;]
* &#8216;kurt1&#8217; = variance of the envelope magnitude
* &#8216;kurt2&#8217; = kurtosis of the complex envelope</li>
<li><strong>level</strong> &#8211; decomposition level for this call</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">kurtosis</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.K_wpQ_filt">
<tt class="descclassname">kurtogram.</tt><tt class="descname">K_wpQ_filt</tt><big>(</big><em>x</em>, <em>h</em>, <em>g</em>, <em>h1</em>, <em>h2</em>, <em>h3</em>, <em>acoeff</em>, <em>bcoeff</em>, <em>level=0</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#K_wpQ_filt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.K_wpQ_filt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the kurtosis K of the complete quinte wavelet packet transform w
of signal x, up to nlevel, using the lowpass and highpass filters h and g,
respectively.  The WP coefficients are sorted according to the frequency
decomposition.
This version handles both real and analytical filters, but does not yield
WP coefficients suitable for signal synthesis.</p>
<p>J. Antoni : 12/2004
Translation to Python: T. Lecocq 02/2012</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>h</strong> &#8211; lowpass filter</li>
<li><strong>g</strong> &#8211; higpass filter</li>
<li><strong>h1</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>h2</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>h3</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>acoeff</strong> &#8211; </li>
<li><strong>acoeff</strong> &#8211; </li>
<li><strong>level</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.K_wpQ_filt_local">
<tt class="descclassname">kurtogram.</tt><tt class="descname">K_wpQ_filt_local</tt><big>(</big><em>x</em>, <em>h</em>, <em>g</em>, <em>h1</em>, <em>h2</em>, <em>h3</em>, <em>acoeff</em>, <em>bcoeff</em>, <em>level</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#K_wpQ_filt_local"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.K_wpQ_filt_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs one analysis level into the analysis tree
TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>h</strong> &#8211; lowpass filter</li>
<li><strong>g</strong> &#8211; higpass filter</li>
<li><strong>h1</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>h2</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>h3</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>acoeff</strong> &#8211; </li>
<li><strong>acoeff</strong> &#8211; </li>
<li><strong>level</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.K_wpQ_local">
<tt class="descclassname">kurtogram.</tt><tt class="descname">K_wpQ_local</tt><big>(</big><em>x</em>, <em>h</em>, <em>g</em>, <em>h1</em>, <em>h2</em>, <em>h3</em>, <em>nlevel</em>, <em>verbose</em>, <em>opt</em>, <em>level</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#K_wpQ_local"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.K_wpQ_local" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : flesh out this doc-string. Is a recursive funtion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>h</strong> &#8211; lowpass filter</li>
<li><strong>g</strong> &#8211; higpass filter</li>
<li><strong>h1</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>h2</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>h3</strong> &#8211; filter parameter returned by get_h_parameters</li>
<li><strong>nlevel</strong> &#8211; number of decomposition levels</li>
<li><strong>verbose</strong> &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> outputs debugging information</li>
<li><strong>opt</strong> &#8211; [&#8216;kurt1&#8217; | &#8216;kurt2&#8217;]
* &#8216;kurt1&#8217; = variance of the envelope magnitude
* &#8216;kurt2&#8217; = kurtosis of the complex envelope</li>
<li><strong>level</strong> &#8211; decomposition level for this call</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">K, KQ</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.TBFB">
<tt class="descclassname">kurtogram.</tt><tt class="descname">TBFB</tt><big>(</big><em>x</em>, <em>h1</em>, <em>h2</em>, <em>h3</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#TBFB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.TBFB" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Trible-band filter-bank.</dt>
<dd>[a1,a2,a3] = TBFB(x,h1,h2,h3)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>h1</strong> &#8211; filter parameter</li>
<li><strong>h2</strong> &#8211; filter parameter</li>
<li><strong>h3</strong> &#8211; filter parameter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a1, a2, a3</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.binary">
<tt class="descclassname">kurtogram.</tt><tt class="descname">binary</tt><big>(</big><em>i</em>, <em>k</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.binary" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Computes the coefficients of the binary expansion of i:</dt>
<dd>i = a(1)*2^(k-1) + a(2)*2^(k-2) + ... + a(k)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> &#8211; integer to expand</li>
<li><strong>k</strong> &#8211; nummber of coefficients</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">coefficients a</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.do_kurtogram_setup_and_run">
<tt class="descclassname">kurtogram.</tt><tt class="descname">do_kurtogram_setup_and_run</tt><big>(</big><em>opdict</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#do_kurtogram_setup_and_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.do_kurtogram_setup_and_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the kurtogram analysis using the parameters contained in the
WavelocOptions.opdict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opdict</strong> &#8211; Dictionary containing the waveloc parameters and options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="data">
<dt id="kurtogram.eps">
<tt class="descclassname">kurtogram.</tt><tt class="descname">eps</tt><em class="property"> = 2.2204460492503131e-16</em><a class="headerlink" href="#kurtogram.eps" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the kurtogram routine of Antoni (2005).</p>
</dd></dl>

<dl class="function">
<dt id="kurtogram.getBandwidthAndFrequency">
<tt class="descclassname">kurtogram.</tt><tt class="descname">getBandwidthAndFrequency</tt><big>(</big><em>nlevel</em>, <em>Fs</em>, <em>level_w</em>, <em>freq_w</em>, <em>level_index</em>, <em>freq_index</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#getBandwidthAndFrequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.getBandwidthAndFrequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets bandwidth and frequency parameters.
TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nlevel</strong> &#8211; </li>
<li><strong>Fs</strong> &#8211; </li>
<li><strong>level_w</strong> &#8211; </li>
<li><strong>freq_w</strong> &#8211; </li>
<li><strong>level_index</strong> &#8211; </li>
<li><strong>freq_index</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.getFTSquaredEnvelope">
<tt class="descclassname">kurtogram.</tt><tt class="descname">getFTSquaredEnvelope</tt><big>(</big><em>c</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#getFTSquaredEnvelope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.getFTSquaredEnvelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Fourier transform of the squared envelope</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>c</strong> &#8211; signal</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns S:</th><td class="field-body">FT of squared envelope</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.get_GridMax">
<tt class="descclassname">kurtogram.</tt><tt class="descname">get_GridMax</tt><big>(</big><em>grid</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#get_GridMax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.get_GridMax" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets maximum of a nD grid and its unraveled index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>grid</strong> &#8211; an nD-grid</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li>M : grid maximum</li>
<li>index : index of maximum in unraveled grid</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.get_h_parameters">
<tt class="descclassname">kurtogram.</tt><tt class="descname">get_h_parameters</tt><big>(</big><em>NFIR</em>, <em>fcut</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#get_h_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.get_h_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates h-parameters used in Antoni (2005)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>NFIR</strong> (<em>integer</em>) &#8211; length of FIR filter</li>
<li><strong>fcut</strong> (<em>float</em>) &#8211; fraction of Nyquist for filter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">h-parameters: h, g, h1, h2, h3</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.kurt">
<tt class="descclassname">kurtogram.</tt><tt class="descname">kurt</tt><big>(</big><em>x</em>, <em>opt</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#kurt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.kurt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates kurtosis of a signal according to the option chosen</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>opt</strong> &#8211; [&#8216;kurt1&#8217; | &#8216;kurt2&#8217;]
* &#8216;kurt1&#8217; = variance of the envelope magnitude
* &#8216;kurt2&#8217; = kurtosis of the complex envelope</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">float</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Kurtosis</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.kurto">
<tt class="descclassname">kurtogram.</tt><tt class="descname">kurto</tt><big>(</big><em>origin_time</em>, <em>info</em>, <em>opdict</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#kurto"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.kurto" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>origin_time</strong> &#8211; </li>
<li><strong>info</strong> &#8211; </li>
<li><strong>opdict</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.nextpow2">
<tt class="descclassname">kurtogram.</tt><tt class="descname">nextpow2</tt><big>(</big><em>n</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#nextpow2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.nextpow2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates next power of 2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> (<em>integer</em>) &#8211; a number</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The next power of 2</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.plot_envelope">
<tt class="descclassname">kurtogram.</tt><tt class="descname">plot_envelope</tt><big>(</big><em>x</em>, <em>Fs</em>, <em>c</em>, <em>fc</em>, <em>level</em>, <em>spec=False</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#plot_envelope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.plot_envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots envelope (with or without its spectrum)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; signal</li>
<li><strong>Fs</strong> &#8211; sampling frequency of signal</li>
<li><strong>c</strong> &#8211; </li>
<li><strong>fc</strong> &#8211; </li>
<li><strong>level</strong> &#8211; </li>
<li><strong>spec</strong> &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> also plots the envelope spectrum</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.plot_kurtogram">
<tt class="descclassname">kurtogram.</tt><tt class="descname">plot_kurtogram</tt><big>(</big><em>Kwav</em>, <em>freq_w</em>, <em>nlevel</em>, <em>Level_w</em>, <em>Fs</em>, <em>fi</em>, <em>index</em>, <em>opt1=None</em>, <em>opt2=None</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#plot_kurtogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.plot_kurtogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the kurtogram. TODO : flesh out this doc-string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Kwav</strong> &#8211; </li>
<li><strong>freq_w</strong> &#8211; </li>
<li><strong>nlevel</strong> &#8211; </li>
<li><strong>level_w</strong> &#8211; </li>
<li><strong>Fs</strong> &#8211; </li>
<li><strong>fi</strong> &#8211; </li>
<li><strong>index</strong> &#8211; </li>
<li><strong>opt1</strong> &#8211; </li>
<li><strong>opt2</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.plot_trace">
<tt class="descclassname">kurtogram.</tt><tt class="descname">plot_trace</tt><big>(</big><em>G</em>, <em>fig</em>, <em>x</em>, <em>xfilt</em>, <em>kurtx</em>, <em>tr</em>, <em>c</em>, <em>info</em>, <em>f_lower</em>, <em>f_upper</em>, <em>snr</em>, <em>snr_ref</em>, <em>snr_kurt</em>, <em>kmax</em>, <em>kmax_ref</em>, <em>tstack</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#plot_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.plot_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot signal and kurtosis for comparison. TODO : flesh out this doc-string.</p>
</dd></dl>

<dl class="function">
<dt id="kurtogram.raylinv">
<tt class="descclassname">kurtogram.</tt><tt class="descname">raylinv</tt><big>(</big><em>p</em>, <em>b</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#raylinv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.raylinv" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Inverse of the Rayleigh cumulative distribution function (cdf).</dt>
<dd>X = RAYLINV(P,B) returns the Rayleigh cumulative distribution function
with parameter B at the probabilities in P.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>p</strong> &#8211; probabilities</li>
<li><strong>b</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.read_kurtogram_frequencies">
<tt class="descclassname">kurtogram.</tt><tt class="descname">read_kurtogram_frequencies</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#read_kurtogram_frequencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.read_kurtogram_frequencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads and plots binary file of kurtogram frequencies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> &#8211; File to read</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.waveval">
<tt class="descclassname">kurtogram.</tt><tt class="descname">waveval</tt><big>(</big><em>xall</em>, <em>tstart</em>, <em>tend</em>, <em>dt</em>, <em>tdeb</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#waveval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.waveval" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>xall</strong> &#8211; </li>
<li><strong>tstart</strong> &#8211; </li>
<li><strong>tend</strong> &#8211; </li>
<li><strong>dt</strong> &#8211; </li>
<li><strong>tdeb</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="kurtogram.write_file">
<tt class="descclassname">kurtogram.</tt><tt class="descname">write_file</tt><big>(</big><em>info</em>, <em>tstart</em>, <em>tend</em>, <em>tr</em><big>)</big><a class="reference internal" href="_modules/kurtogram.html#write_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kurtogram.write_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes kurtosis file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>info</strong> &#8211; dictionary of parameters</li>
<li><strong>tstart</strong> &#8211; start-time</li>
<li><strong>tend</strong> &#8211; end-time</li>
<li><strong>tr</strong> &#8211; trace to write</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-SDS_processing">
<span id="sds-processing"></span><h3>SDS_processing<a class="headerlink" href="#module-SDS_processing" title="Permalink to this headline">¶</a></h3>
<p>The module SDS_processing contains functions to apply Waveloc specific
processing on data contained in an SDS file structure.</p>
<dl class="function">
<dt id="SDS_processing.do_SDS_processing_setup_and_run">
<tt class="descclassname">SDS_processing.</tt><tt class="descname">do_SDS_processing_setup_and_run</tt><big>(</big><em>opdict</em><big>)</big><a class="reference internal" href="_modules/SDS_processing.html#do_SDS_processing_setup_and_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SDS_processing.do_SDS_processing_setup_and_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Does all the processing for an SDS archive. All options are given within a
<em>WavlocOptions</em> object. Steps are:</p>
<ul class="simple">
<li>reading data</li>
<li>filtering</li>
<li>resampling if requested</li>
<li>applying kurtosis processing</li>
<li>calculating kurtosis gradient if requested</li>
<li>convolving with gaussian if requested</li>
<li>writing processed files at each stage</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opdict</strong> (<em>dictionary</em>) &#8211; Dictionary of options. Refers the the opdict attribute of
<em>WavelocOptions</em> objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SDS_processing.read_channel_file">
<tt class="descclassname">SDS_processing.</tt><tt class="descname">read_channel_file</tt><big>(</big><em>fname</em><big>)</big><a class="reference internal" href="_modules/SDS_processing.html#read_channel_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SDS_processing.read_channel_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a channel file containing network-code, station-name, component-name
triplets. Can be used to provide fine control of data to be processed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fname</strong> (<em>string</em>) &#8211; File to be read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of tuples. Each tuple contains network-name, station-name,
channel-name as strings.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="migration">
<h2>MIGRATION<a class="headerlink" href="#migration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-integrate4D">
<span id="integrate4d"></span><h3>integrate4D<a class="headerlink" href="#module-integrate4D" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="integrate4D.compute_expected_coordinates1D">
<tt class="descclassname">integrate4D.</tt><tt class="descname">compute_expected_coordinates1D</tt><big>(</big><em>grid</em>, <em>x0</em><big>)</big><a class="reference internal" href="_modules/integrate4D.html#compute_expected_coordinates1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#integrate4D.compute_expected_coordinates1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes expected value and variance of a 1D grid along its (only) axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>numpy array</em>) &#8211; 1D grid to integrate</li>
<li><strong>x0</strong> (<em>numpy array</em>) &#8211; coordinates of all points along the integration axis</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">float</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>exp_x0 : expected value</li>
<li>var_x0 : variance</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="integrate4D.compute_expected_coordinates3D">
<tt class="descclassname">integrate4D.</tt><tt class="descname">compute_expected_coordinates3D</tt><big>(</big><em>grid</em>, <em>x0</em>, <em>x1</em>, <em>x2</em>, <em>return_2Dgrids=False</em><big>)</big><a class="reference internal" href="_modules/integrate4D.html#compute_expected_coordinates3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#integrate4D.compute_expected_coordinates3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes expected coordinates of a 3D grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>numpy array</em>) &#8211; 3D grid to integrate</li>
<li><strong>x0</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=0</li>
<li><strong>x1</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=1</li>
<li><strong>x2</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=2</li>
<li><strong>return_2Dgrids</strong> (<em>boolean</em>) &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt> returns the 1D and 2D marginals in a
dictionary.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>exp_x0 : expected value along axis=0</li>
<li>exp_x1 : expected value along axis=1</li>
<li>exp_x2 : expected value along axis=2</li>
<li>cov_matrix : covariance matrix</li>
<li>grid_dict : dictionary containing 1D and 2D marginals (optional)</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="integrate4D.compute_expected_coordinates4D">
<tt class="descclassname">integrate4D.</tt><tt class="descname">compute_expected_coordinates4D</tt><big>(</big><em>grid</em>, <em>x0</em>, <em>x1</em>, <em>x2</em>, <em>x3</em>, <em>return_2Dgrids=False</em><big>)</big><a class="reference internal" href="_modules/integrate4D.html#compute_expected_coordinates4D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#integrate4D.compute_expected_coordinates4D" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes expected coordinates of a 4D grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>numpy array</em>) &#8211; 4D grid to integrate</li>
<li><strong>x0</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=0</li>
<li><strong>x1</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=1</li>
<li><strong>x2</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=2</li>
<li><strong>x3</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=3</li>
<li><strong>return_2Dgrids</strong> (<em>boolean</em>) &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt> returns the 1D and 2D marginals in a
dictionary.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>exp_x0 : expected value along axis=0</li>
<li>exp_x1 : expected value along axis=1</li>
<li>exp_x2 : expected value along axis=2</li>
<li>exp_x3 : expected value along axis=2</li>
<li>cov_matrix : covariance matrix</li>
<li>grid_dict : dictionary containing 1D and 2D marginals (optional)</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="integrate4D.compute_integral1D">
<tt class="descclassname">integrate4D.</tt><tt class="descname">compute_integral1D</tt><big>(</big><em>grid</em>, <em>x0</em><big>)</big><a class="reference internal" href="_modules/integrate4D.html#compute_integral1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#integrate4D.compute_integral1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes norm of a 1D grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>numpy array</em>) &#8211; 1D grid to integrate</li>
<li><strong>x0</strong> (<em>numpy array</em>) &#8211; coordinates of all points along the integration axis</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">float</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">grid norm</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="integrate4D.compute_integral3D">
<tt class="descclassname">integrate4D.</tt><tt class="descname">compute_integral3D</tt><big>(</big><em>grid</em>, <em>x0</em>, <em>x1</em>, <em>x2</em><big>)</big><a class="reference internal" href="_modules/integrate4D.html#compute_integral3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#integrate4D.compute_integral3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes norm of a 3D grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>numpy array</em>) &#8211; 3D grid to integrate</li>
<li><strong>x0</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=0</li>
<li><strong>x1</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=1</li>
<li><strong>x2</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">float</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">grid norm</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="integrate4D.compute_integral4D">
<tt class="descclassname">integrate4D.</tt><tt class="descname">compute_integral4D</tt><big>(</big><em>grid</em>, <em>x0</em>, <em>x1</em>, <em>x2</em>, <em>x3</em><big>)</big><a class="reference internal" href="_modules/integrate4D.html#compute_integral4D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#integrate4D.compute_integral4D" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes norm of a 4D grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>numpy array</em>) &#8211; 4D grid to integrate</li>
<li><strong>x0</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=0</li>
<li><strong>x1</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=1</li>
<li><strong>x2</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=2</li>
<li><strong>x3</strong> (<em>numpy array</em>) &#8211; coordinates of all points along axis=3</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">float</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">grid norm</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="location">
<h2>LOCATION<a class="headerlink" href="#location" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-locations_trigger">
<span id="locations-trigger"></span><h3>locations_trigger<a class="headerlink" href="#module-locations_trigger" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="locations_trigger.do_locations_trigger_setup_and_run">
<tt class="descclassname">locations_trigger.</tt><tt class="descname">do_locations_trigger_setup_and_run</tt><big>(</big><em>opdict</em><big>)</big><a class="reference internal" href="_modules/locations_trigger.html#do_locations_trigger_setup_and_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locations_trigger.do_locations_trigger_setup_and_run" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Run locations trigger. Takes all options and paramters from</dt>
<dd>WavelocOptions.opdict dictionary.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opdict</strong> &#8211; Dictionary of waveloc options / parameters.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="locations_trigger.number_good_kurtosis_for_location">
<tt class="descclassname">locations_trigger.</tt><tt class="descname">number_good_kurtosis_for_location</tt><big>(</big><em>kurt_files</em>, <em>data_files</em>, <em>loc</em>, <em>time_dict</em>, <em>snr_limit=10.0</em>, <em>snr_tr_limit=10.0</em>, <em>sn_time=10.0</em><big>)</big><a class="reference internal" href="_modules/locations_trigger.html#number_good_kurtosis_for_location"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locations_trigger.number_good_kurtosis_for_location" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyses the filtered data and the kurtosis time-series to determine the
number of stations whose traces have sufficiently high signal-to-noise
ratio (SNR) to be useful for the location. Both time-series need to satisfy
the conditions for a station to be counted as contributing to the location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kurt_files</strong> &#8211; Filenames for kurtosis files. Depending on the filenames
given in this list, the function will analyse kurtosis,
kurtosis-gradient or gaussian waveforms.</li>
<li><strong>data_files</strong> &#8211; Filenames for filtered data.</li>
<li><strong>loc</strong> &#8211; Location dictionary for the event to be analysed</li>
<li><strong>time_dict</strong> &#8211; Dictionary of travel-times for the location to be
analysed</li>
<li><strong>snr_limit</strong> &#8211; SNR limit for kurtosis-type data</li>
<li><strong>snr_limit_tr</strong> &#8211; SNR limit for filtered data</li>
<li><strong>snr_time</strong> &#8211; Length of time in seconds before the event for computation
of SNR.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">integer</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Numer of stations that have contributed to the location.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="locations_trigger.plot_location_triggers">
<tt class="descclassname">locations_trigger.</tt><tt class="descname">plot_location_triggers</tt><big>(</big><em>trace</em>, <em>trig_start</em>, <em>trig_end</em>, <em>trig_95_start</em>, <em>trig_95_end</em>, <em>show=True</em><big>)</big><a class="reference internal" href="_modules/locations_trigger.html#plot_location_triggers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locations_trigger.plot_location_triggers" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the location (in time) of the triggers.
TODO : Flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>trace</strong> &#8211; </li>
<li><strong>trig_start</strong> &#8211; </li>
<li><strong>trig_end</strong> &#8211; </li>
<li><strong>trig_95_start</strong> &#8211; </li>
<li><strong>trig_95_end</strong> &#8211; </li>
<li><strong>show</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="locations_trigger.read_header_from_file">
<tt class="descclassname">locations_trigger.</tt><tt class="descname">read_header_from_file</tt><big>(</big><em>filename</em>, <em>opdict</em><big>)</big><a class="reference internal" href="_modules/locations_trigger.html#read_header_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locations_trigger.read_header_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read header information from a location file into a WavelocOptions.opdict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> &#8211; File to read.</li>
<li><strong>opdict</strong> &#8211; Waveloc options dictionary to write into.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">opdict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="locations_trigger.read_locs_from_file">
<tt class="descclassname">locations_trigger.</tt><tt class="descname">read_locs_from_file</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/locations_trigger.html#read_locs_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locations_trigger.read_locs_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read locations from file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> &#8211; File to read.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of locations (each location is a dictionary)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="locations_trigger.trigger_locations_inner">
<tt class="descclassname">locations_trigger.</tt><tt class="descname">trigger_locations_inner</tt><big>(</big><em>max_val</em>, <em>max_x</em>, <em>max_y</em>, <em>max_z</em>, <em>left_trig</em>, <em>right_trig</em>, <em>start_time</em>, <em>delta</em><big>)</big><a class="reference internal" href="_modules/locations_trigger.html#trigger_locations_inner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locations_trigger.trigger_locations_inner" title="Permalink to this definition">¶</a></dt>
<dd><p>Inner loop of the location process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>max_val</strong> &#8211; Time-series of stack-max.</li>
<li><strong>max_x</strong> &#8211; Time-series of the x-positions corresponding to stack-max.</li>
<li><strong>max_y</strong> &#8211; Time-series of the y-positions corresponding to stack-max.</li>
<li><strong>max_z</strong> &#8211; Time-series of the z-positions corresponding to stack-max.</li>
<li><strong>left_trig</strong> &#8211; Amplitude for trigger-on.</li>
<li><strong>right_trig</strong> &#8211; Amplitude for trigger-off.</li>
<li><strong>start_time</strong> &#8211; UTCDateTime of the first point in the time-series.</li>
<li><strong>delta</strong> &#8211; Sampling interval of the time-series</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List of locations. Each location is a dictionary containing all
the relevant information.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="locations_trigger.write_header_options">
<tt class="descclassname">locations_trigger.</tt><tt class="descname">write_header_options</tt><big>(</big><em>loc_file</em>, <em>opdict</em><big>)</big><a class="reference internal" href="_modules/locations_trigger.html#write_header_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locations_trigger.write_header_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the information regarding how the locations were generated to an
already opened location file. This information becomes a location &#8220;header&#8221;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>loc_file</strong> &#8211; File object to which the information will be written.</li>
<li><strong>opdict</strong> &#8211; Waveloc options dictionary</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-locations_prob">
<span id="locations-prob"></span><h3>locations_prob<a class="headerlink" href="#module-locations_prob" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="locations_prob.do_locations_prob_setup_and_run">
<tt class="descclassname">locations_prob.</tt><tt class="descname">do_locations_prob_setup_and_run</tt><big>(</big><em>opdict</em><big>)</big><a class="reference internal" href="_modules/locations_prob.html#do_locations_prob_setup_and_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locations_prob.do_locations_prob_setup_and_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup and run probability-based locations on migration grids. Takes all
parameters from WavelocOptions.opdict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opdict</strong> &#8211; Parameters and options for Waveloc.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="locations_prob.read_prob_locs_from_file">
<tt class="descclassname">locations_prob.</tt><tt class="descname">read_prob_locs_from_file</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/locations_prob.html#read_prob_locs_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locations_prob.read_prob_locs_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read file containing probability determined locations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> &#8211; File to be read.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Dictionary of locations</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-magnitude">
<span id="magnitude"></span><h3>magnitude<a class="headerlink" href="#module-magnitude" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="magnitude.bvalue">
<tt class="descclassname">magnitude.</tt><tt class="descname">bvalue</tt><big>(</big><em>mag</em>, <em>r</em><big>)</big><a class="reference internal" href="_modules/magnitude.html#bvalue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magnitude.bvalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the b-value by a simple linear fitting</p>
</dd></dl>

<dl class="function">
<dt id="magnitude.do_comp_mag">
<tt class="descclassname">magnitude.</tt><tt class="descname">do_comp_mag</tt><big>(</big><em>opdict</em><big>)</big><a class="reference internal" href="_modules/magnitude.html#do_comp_mag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magnitude.do_comp_mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the magnitude computation, using options in WavelocOptions.opdict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opdict</strong> &#8211; Dictionary containing waveloc options and parameters.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magnitude.fill_values">
<tt class="descclassname">magnitude.</tt><tt class="descname">fill_values</tt><big>(</big><em>vals</em>, <em>tdeb</em>, <em>data_glob</em>, <em>data_dir</em>, <em>comp</em><big>)</big><a class="reference internal" href="_modules/magnitude.html#fill_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magnitude.fill_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a dictionnary with all values for each channel of each station.
TODO : Flesh out this doc-string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>vals</strong> &#8211; </li>
<li><strong>tdeb</strong> &#8211; </li>
<li><strong>data_glob</strong> &#8211; </li>
<li><strong>data_dir</strong> &#8211; </li>
<li><strong>comp</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magnitude.read_paz">
<tt class="descclassname">magnitude.</tt><tt class="descname">read_paz</tt><big>(</big><em>files</em><big>)</big><a class="reference internal" href="_modules/magnitude.html#read_paz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magnitude.read_paz" title="Permalink to this definition">¶</a></dt>
<dd><p>Read dataless and extract poles and zeros from dataless SEED files. Based
on obspy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>files</strong> &#8211; Files to read.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="clustering">
<h2>CLUSTERING<a class="headerlink" href="#clustering" title="Permalink to this headline">¶</a></h2>
<p>This part of the waveloc code was contributed by Nadège Langet during her PhD
thesis.</p>
<div class="section" id="module-correlation">
<span id="correlation"></span><h3>correlation<a class="headerlink" href="#module-correlation" title="Permalink to this headline">¶</a></h3>
<p>Provides classes and functions for cross-correlation.</p>
<dl class="class">
<dt id="correlation.BinaryFile">
<em class="property">class </em><tt class="descclassname">correlation.</tt><tt class="descname">BinaryFile</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/correlation.html#BinaryFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.BinaryFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that reads, writes and stores the binary files containing the
correlation matrix.</p>
<dl class="method">
<dt id="correlation.BinaryFile.read_binary_file">
<tt class="descname">read_binary_file</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/correlation.html#BinaryFile.read_binary_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.BinaryFile.read_binary_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the binary file from disk and returns un-pickled data
:rtype: numpy array ?
:returns: data read from tile</p>
</dd></dl>

<dl class="method">
<dt id="correlation.BinaryFile.write_binary_file">
<tt class="descname">write_binary_file</tt><big>(</big><em>input</em><big>)</big><a class="reference internal" href="_modules/correlation.html#BinaryFile.write_binary_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.BinaryFile.write_binary_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a binary file from disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input</strong> &#8211; input data ready to be pickled</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="correlation.corr_freq">
<tt class="descclassname">correlation.</tt><tt class="descname">corr_freq</tt><big>(</big><em>f</em>, <em>Cxy</em>, <em>v</em><big>)</big><a class="reference internal" href="_modules/correlation.html#corr_freq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.corr_freq" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the time lag entirely in the spectral domain, using the slope of
the phase spectrum where the amplitude is strong.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f</strong> (<em>numpy array</em>) &#8211; frequency vector</li>
<li><strong>Cxy</strong> (<em>numpy array</em>) &#8211; frequency domain cross-correlation vector</li>
<li><strong>v</strong> (<em>boolean</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> displays Cxy</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">float</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">time-lag</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="correlation.corr_time">
<tt class="descclassname">correlation.</tt><tt class="descname">corr_time</tt><big>(</big><em>Cxy</em>, <em>Cxx</em>, <em>Cyy</em>, <em>dt</em>, <em>v</em><big>)</big><a class="reference internal" href="_modules/correlation.html#corr_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.corr_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns maximum of cross-correlation and time-lag given frequency domain
cross- and auto- correlation vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Cxy</strong> (<em>numpy array</em>) &#8211; frequency domain cross-correlation</li>
<li><strong>Cxx</strong> (<em>numpy array</em>) &#8211; frequency domain auto-correlation</li>
<li><strong>Cyy</strong> (<em>numpy array</em>) &#8211; frequency domain auto-correlation</li>
<li><strong>dt</strong> (<em>float</em>) &#8211; time step</li>
<li><strong>v</strong> (<em>boolean</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> plots cross-correlation in the time-domain</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">float</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">value_t, tau_t, respectively the cross-correlation maximum value
and time-lag</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="correlation.correlate">
<tt class="descclassname">correlation.</tt><tt class="descname">correlate</tt><big>(</big><em>x</em>, <em>y</em>, <em>dt</em>, <em>v</em>, <em>a</em><big>)</big><a class="reference internal" href="_modules/correlation.html#correlate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.correlate" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs correlation on two signals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>numpy array</em>) &#8211; waveform</li>
<li><strong>y</strong> (<em>numpy array</em>) &#8211; waveform</li>
<li><strong>dt</strong> (<em>float</em>) &#8211; time-step</li>
<li><strong>v</strong> (<em>boolean</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> makes plots</li>
<li><strong>a</strong> (<em>char</em>) &#8211; [&#8216;t&#8217; | &#8216;f&#8217;] for time-domain or frequency-domain extraction of
time-lag</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">float</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>The returned values depend on the <em>a</em> input parameter:</p>
<ul class="simple">
<li>a=&#8217;t&#8217; : returns time-lag and correlation value</li>
<li>a=&#8217;f&#8217; : returns time-lag</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="correlation.cum">
<tt class="descclassname">correlation.</tt><tt class="descname">cum</tt><big>(</big><em>x</em>, <em>v</em><big>)</big><a class="reference internal" href="_modules/correlation.html#cum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.cum" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>numpy array</em>) &#8211; </li>
<li><strong>v</strong> (<em>boolean</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt> then plot x and cumulative sum of x</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">int</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">mini, max_i</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="correlation.display">
<tt class="descclassname">correlation.</tt><tt class="descname">display</tt><big>(</big><em>Cxy</em>, <em>f</em>, <em>a</em>, <em>f_min_max</em><big>)</big><a class="reference internal" href="_modules/correlation.html#display"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.display" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays amplitude and phase of the frequency domain cross-correlation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Cxy</strong> (<em>numpy array</em>) &#8211; frequency domain cross-correlation</li>
<li><strong>f</strong> (<em>numpy array</em>) &#8211; frequency vector</li>
<li><strong>a</strong> &#8211; </li>
<li><strong>f_min_max</strong> (<em>numpy array</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="correlation.do_correlation_setup_and_run">
<tt class="descclassname">correlation.</tt><tt class="descname">do_correlation_setup_and_run</tt><big>(</big><em>opdict</em><big>)</big><a class="reference internal" href="_modules/correlation.html#do_correlation_setup_and_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.do_correlation_setup_and_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs correlation using options contained in a WavelocOptions.opdict
dictionary.</p>
<p>TODO : Flesh out this doc-string by explaining the sequence of operations</p>
</dd></dl>

<dl class="function">
<dt id="correlation.fourier">
<tt class="descclassname">correlation.</tt><tt class="descname">fourier</tt><big>(</big><em>x</em>, <em>y</em>, <em>dt</em><big>)</big><a class="reference internal" href="_modules/correlation.html#fourier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.fourier" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cross-correlation and auto-correlation vectors of two signals in
the frequency domain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>numpy array</em>) &#8211; first signal</li>
<li><strong>y</strong> (<em>numpy array</em>) &#8211; second signal</li>
<li><strong>dt</strong> (<em>float</em>) &#8211; time-step of both signals</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy arrays</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Cxy, Cxx, Cyy, f</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="correlation.plot_waveform">
<tt class="descclassname">correlation.</tt><tt class="descname">plot_waveform</tt><big>(</big><em>x</em>, <em>y</em>, <em>dt</em>, <em>tau</em>, <em>ev1</em>, <em>ev2</em><big>)</big><a class="reference internal" href="_modules/correlation.html#plot_waveform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.plot_waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the waveforms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>numpy array</em>) &#8211; waveform</li>
<li><strong>y</strong> (<em>numpy array</em>) &#8211; waveform</li>
<li><strong>dt</strong> (<em>float</em>) &#8211; time-step</li>
<li><strong>tau</strong> (<em>float</em>) &#8211; time-lag</li>
<li><strong>ev1</strong> (<em>string</em>) &#8211; name of event shown in waveform x</li>
<li><strong>ev2</strong> (<em>string</em>) &#8211; name of event shown in waveform y</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="correlation.waveform">
<tt class="descclassname">correlation.</tt><tt class="descname">waveform</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/correlation.html#waveform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#correlation.waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to read a seismogram and return its data, time-step,
station name and start-time</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>string</em>) &#8211; File to read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">val, dt, name, tdeb<ul class="simple">
<li>val = seismogram values</li>
<li>dt = time-step</li>
<li>name = station name</li>
<li>tdeb = start-time (UTCDateTime)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="id1">
<h3>clustering<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-clustering"></span><p>Provides classes and functions for clustering of earthquakes based on the
depth-first algorithm.</p>
<dl class="function">
<dt id="clustering.CZ_DFS">
<tt class="descclassname">clustering.</tt><tt class="descname">CZ_DFS</tt><big>(</big><em>GRAPH</em>, <em>sommet_first</em>, <em>cluster_ind</em><big>)</big><a class="reference internal" href="_modules/clustering.html#CZ_DFS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.CZ_DFS" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of the depth first search algorithm. This is a recursive
algorithm.
TODO : flesh out this doc-string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>GRAPH</strong> (<em>Graph object</em>) &#8211; </li>
<li><strong>sommet_first</strong> (<em>integer</em>) &#8211; </li>
<li><strong>cluster_ind</strong> (<em>integer</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="clustering.Graph">
<em class="property">class </em><tt class="descclassname">clustering.</tt><tt class="descname">Graph</tt><a class="reference internal" href="_modules/clustering.html#Graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.Graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Class of Graph objects. Contains 4 attributes:</p>
<ul class="simple">
<li>flag</li>
<li>cluster_index</li>
<li>voisins (neighbours)</li>
<li>nb_voisins (number of neighbours)</li>
</ul>
<p>TODO: Flesh out this doc-string. The structure of this object is very
obscure...</p>
<dl class="method">
<dt id="clustering.Graph.set_cluster_index">
<tt class="descname">set_cluster_index</tt><big>(</big><em>value</em><big>)</big><a class="reference internal" href="_modules/clustering.html#Graph.set_cluster_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.Graph.set_cluster_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends value to cluster_index attribute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>integer ??</em>) &#8211; Value to append.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="clustering.Graph.set_flag">
<tt class="descname">set_flag</tt><big>(</big><em>value</em><big>)</big><a class="reference internal" href="_modules/clustering.html#Graph.set_flag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.Graph.set_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends value to flag attribute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>int</em>) &#8211; Value to append (0=False, 1=True).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="clustering.Graph.set_voisins">
<tt class="descname">set_voisins</tt><big>(</big><em>value</em><big>)</big><a class="reference internal" href="_modules/clustering.html#Graph.set_voisins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.Graph.set_voisins" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends value to voisins attribute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>integer ??</em>) &#8211; Value to append.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="clustering.compute_nbsta">
<tt class="descclassname">clustering.</tt><tt class="descname">compute_nbsta</tt><big>(</big><em>event</em>, <em>coeff</em>, <em>threshold</em><big>)</big><a class="reference internal" href="_modules/clustering.html#compute_nbsta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.compute_nbsta" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>event</strong> &#8211; </li>
<li><strong>coeff</strong> &#8211; </li>
<li><strong>threshold</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy maxtrix containing integers</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">matrix of number of stations</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="clustering.do_clustering">
<tt class="descclassname">clustering.</tt><tt class="descname">do_clustering</tt><big>(</big><em>event</em>, <em>nbsta</em>, <em>nbmin</em><big>)</big><a class="reference internal" href="_modules/clustering.html#do_clustering"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.do_clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>event</strong> &#8211; </li>
<li><strong>nbsta</strong> (<em>integer</em>) &#8211; </li>
<li><strong>nbmin</strong> (<em>integer</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="clustering.do_clustering_setup_and_run">
<tt class="descclassname">clustering.</tt><tt class="descname">do_clustering_setup_and_run</tt><big>(</big><em>opdict</em><big>)</big><a class="reference internal" href="_modules/clustering.html#do_clustering_setup_and_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.do_clustering_setup_and_run" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opdict</strong> &#8211; Dictionary of waveloc options</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="clustering.plot_graphs">
<tt class="descclassname">clustering.</tt><tt class="descname">plot_graphs</tt><big>(</big><em>locs</em>, <em>stations</em>, <em>nbsta</em>, <em>CLUSTER</em>, <em>nbmin</em>, <em>threshold</em><big>)</big><a class="reference internal" href="_modules/clustering.html#plot_graphs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.plot_graphs" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : flesh out this doc-string
Uses mlab from mayavi</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>locs</strong> &#8211; </li>
<li><strong>stations</strong> &#8211; </li>
<li><strong>nbsta</strong> &#8211; </li>
<li><strong>CLUSTER</strong> &#8211; </li>
<li><strong>nbmin</strong> &#8211; </li>
<li><strong>threshold</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="clustering.plot_traces">
<tt class="descclassname">clustering.</tt><tt class="descname">plot_traces</tt><big>(</big><em>CLUSTER</em>, <em>delay_file</em>, <em>coeff</em>, <em>locs</em>, <em>stations</em>, <em>datadir</em>, <em>data_files</em>, <em>threshold</em><big>)</big><a class="reference internal" href="_modules/clustering.html#plot_traces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.plot_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>CLUSTER</strong> &#8211; </li>
<li><strong>delay_file</strong> &#8211; </li>
<li><strong>coeff</strong> &#8211; </li>
<li><strong>locs</strong> &#8211; </li>
<li><strong>statons</strong> &#8211; </li>
<li><strong>datadir</strong> &#8211; </li>
<li><strong>data_files</strong> &#8211; </li>
<li><strong>threshold</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="clustering.waveval">
<tt class="descclassname">clustering.</tt><tt class="descname">waveval</tt><big>(</big><em>stack_time</em>, <em>t_before</em>, <em>t_after</em>, <em>dt</em>, <em>tdeb</em><big>)</big><a class="reference internal" href="_modules/clustering.html#waveval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.waveval" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stack_time</strong> (<em>float?</em>) &#8211; </li>
<li><strong>t_before</strong> (<em>float?</em>) &#8211; </li>
<li><strong>t_after</strong> (<em>float?</em>) &#8211; </li>
<li><strong>dt</strong> (<em>float</em>) &#8211; </li>
<li><strong>tdeb</strong> (<em>float ?</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">integer</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">indexes corresponding to t_before and t_after</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-double_diff">
<span id="double-diff"></span><h3>double_diff<a class="headerlink" href="#module-double_diff" title="Permalink to this headline">¶</a></h3>
<p>Routines to do double-difference relative location of events.</p>
<dl class="function">
<dt id="double_diff.centroid_constraint">
<tt class="descclassname">double_diff.</tt><tt class="descname">centroid_constraint</tt><big>(</big><em>G</em>, <em>d</em>, <em>W</em><big>)</big><a class="reference internal" href="_modules/double_diff.html#centroid_constraint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#double_diff.centroid_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies centroid constraint: sum(delta m)=0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>G</strong> &#8211; matrix of partial derivatives</li>
<li><strong>d</strong> &#8211; vector of double-difference times</li>
<li><strong>W</strong> &#8211; weighting matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Updated versions of G, d, W</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="double_diff.coord_cluster">
<tt class="descclassname">double_diff.</tt><tt class="descname">coord_cluster</tt><big>(</big><em>cluster</em>, <em>locs</em><big>)</big><a class="reference internal" href="_modules/double_diff.html#coord_cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#double_diff.coord_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the coordinates of the events of a given cluster
TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; </li>
<li><strong>locs</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">xini, yini, zini, zini_ph, to_ini</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="double_diff.do_double_diff">
<tt class="descclassname">double_diff.</tt><tt class="descname">do_double_diff</tt><big>(</big><em>x</em>, <em>y</em>, <em>z</em>, <em>to</em>, <em>stations</em>, <em>coeff</em>, <em>delay</em>, <em>cluster</em>, <em>threshold</em>, <em>t_th</em>, <em>arr_times</em><big>)</big><a class="reference internal" href="_modules/double_diff.html#do_double_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#double_diff.do_double_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Do double difference location (inner routine)
TODO : flesh out this doc-string explaining the sequence of operations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; </li>
<li><strong>y</strong> &#8211; </li>
<li><strong>z</strong> &#8211; </li>
<li><strong>to</strong> &#8211; </li>
<li><strong>stations</strong> &#8211; </li>
<li><strong>coeff</strong> &#8211; </li>
<li><strong>delay</strong> &#8211; </li>
<li><strong>cluster</strong> &#8211; </li>
<li><strong>threshold</strong> &#8211; </li>
<li><strong>t_th</strong> &#8211; </li>
<li><strong>arr_times</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="double_diff.do_double_diff_setup_and_run">
<tt class="descclassname">double_diff.</tt><tt class="descname">do_double_diff_setup_and_run</tt><big>(</big><em>opdict</em><big>)</big><a class="reference internal" href="_modules/double_diff.html#do_double_diff_setup_and_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#double_diff.do_double_diff_setup_and_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Do double difference (outer routine). Takes options from a
WavelocOptions.opdict dictionary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opdict</strong> &#8211; Dictionary of parameters and options</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="double_diff.fill_matrix">
<tt class="descclassname">double_diff.</tt><tt class="descname">fill_matrix</tt><big>(</big><em>cluster</em>, <em>x</em>, <em>y</em>, <em>z</em>, <em>t_orig</em>, <em>stations</em>, <em>t_th</em>, <em>t_arr</em>, <em>coeff</em>, <em>delay</em>, <em>threshold</em><big>)</big><a class="reference internal" href="_modules/double_diff.html#fill_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#double_diff.fill_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills in matrix G (partial derivatives) data-vector d (double differences)
and matrix W (weights)
TODO : flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cluster</strong> &#8211; </li>
<li><strong>x</strong> &#8211; </li>
<li><strong>y</strong> &#8211; </li>
<li><strong>z</strong> &#8211; </li>
<li><strong>t_orig</strong> &#8211; </li>
<li><strong>stations</strong> &#8211; </li>
<li><strong>t_th</strong> &#8211; </li>
<li><strong>t_arr</strong> &#8211; </li>
<li><strong>coeff</strong> &#8211; </li>
<li><strong>delay</strong> &#8211; </li>
<li><strong>threshold</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="double_diff.inversion">
<tt class="descclassname">double_diff.</tt><tt class="descname">inversion</tt><big>(</big><em>G</em>, <em>d</em>, <em>W</em><big>)</big><a class="reference internal" href="_modules/double_diff.html#inversion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#double_diff.inversion" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverts G, d, W using LSQR to obtain parameter vector m</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>G</strong> &#8211; matrix of partial derivatives</li>
<li><strong>d</strong> &#8211; vector of double-difference times</li>
<li><strong>W</strong> &#8211; weighting matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Parameter vector m</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="double_diff.partial_deriv">
<tt class="descclassname">double_diff.</tt><tt class="descname">partial_deriv</tt><big>(</big><em>coord</em>, <em>ev</em>, <em>tth</em><big>)</big><a class="reference internal" href="_modules/double_diff.html#partial_deriv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#double_diff.partial_deriv" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes partial derivatives
TODO flesh out this doc-string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>coord</strong> &#8211; </li>
<li><strong>ev</strong> &#8211; </li>
<li><strong>tth</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dpx, dpy, dpz</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="double_diff.plot_events">
<tt class="descclassname">double_diff.</tt><tt class="descname">plot_events</tt><big>(</big><em>cluster</em>, <em>locs</em>, <em>stations</em>, <em>x</em>, <em>y</em>, <em>z</em>, <em>i</em>, <em>threshold</em>, <em>nbmin</em>, <em>area</em>, <em>nbsta</em><big>)</big><a class="reference internal" href="_modules/double_diff.html#plot_events"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#double_diff.plot_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot old and new locations (uses mayavi)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cluster</strong> &#8211; </li>
<li><strong>locs</strong> &#8211; </li>
<li><strong>stations</strong> &#8211; </li>
<li><strong>x</strong> &#8211; </li>
<li><strong>y</strong> &#8211; </li>
<li><strong>z</strong> &#8211; </li>
<li><strong>i</strong> &#8211; </li>
<li><strong>threshold</strong> &#8211; </li>
<li><strong>nbmin</strong> &#8211; </li>
<li><strong>area</strong> &#8211; </li>
<li><strong>nbsta</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="double_diff.traveltimes">
<tt class="descclassname">double_diff.</tt><tt class="descname">traveltimes</tt><big>(</big><em>x</em>, <em>y</em>, <em>z</em>, <em>t_orig</em>, <em>stations</em>, <em>time_grids</em><big>)</big><a class="reference internal" href="_modules/double_diff.html#traveltimes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#double_diff.traveltimes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute theoretical traveltimes and arrival times for a point to all
stations using pre-calculated time-grids</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>float</em>) &#8211; x-coordinate of point</li>
<li><strong>y</strong> (<em>float</em>) &#8211; y-coordinate of point</li>
<li><strong>z</strong> (<em>float</em>) &#8211; z-coordinate of point</li>
<li><strong>t_orig</strong> (<em>UTCDateTime</em>) &#8211; origin time of envent (used to calculate arrival times)</li>
<li><strong>stations</strong> (<em>string</em>) &#8211; list of station names</li>
<li><strong>time_grids</strong> &#8211; dictionary of time-grids</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">dictionary</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">t_th, arr_times</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-CZ_color">
<span id="cz-color"></span><h3>CZ_color<a class="headerlink" href="#module-CZ_color" title="Permalink to this headline">¶</a></h3>
<p>Provides colors for clustering routines.</p>
<dl class="function">
<dt id="CZ_color.CZ_Clust_2_color">
<tt class="descclassname">CZ_color.</tt><tt class="descname">CZ_Clust_2_color</tt><big>(</big><em>dt</em><big>)</big><a class="reference internal" href="_modules/CZ_color.html#CZ_Clust_2_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CZ_color.CZ_Clust_2_color" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: Add doc-string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dt</strong> (<em>float</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of 3 values between 0 and 1 for color indexing.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="CZ_color.CZ_W_2_color">
<tt class="descclassname">CZ_color.</tt><tt class="descname">CZ_W_2_color</tt><big>(</big><em>dt</em><big>)</big><a class="reference internal" href="_modules/CZ_color.html#CZ_W_2_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CZ_color.CZ_W_2_color" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: Add doc-string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dt</strong> (<em>float</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of 3 values between 0 and 1 for color indexing.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">WaveLoc API</a><ul>
<li><a class="reference internal" href="#travel-times">TRAVEL-TIMES</a><ul>
<li><a class="reference internal" href="#module-NllGridLib">NllGridLib</a></li>
<li><a class="reference internal" href="#hdf5-grids">hdf5_grids</a></li>
</ul>
</li>
<li><a class="reference internal" href="#waveforms">WAVEFORMS</a><ul>
<li><a class="reference internal" href="#module-OP_waveforms">OP_waveform</a></li>
<li><a class="reference internal" href="#module-filters">filters</a></li>
<li><a class="reference internal" href="#module-kurtogram">kurtogram</a></li>
<li><a class="reference internal" href="#module-SDS_processing">SDS_processing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#migration">MIGRATION</a><ul>
<li><a class="reference internal" href="#module-integrate4D">integrate4D</a></li>
</ul>
</li>
<li><a class="reference internal" href="#location">LOCATION</a><ul>
<li><a class="reference internal" href="#module-locations_trigger">locations_trigger</a></li>
<li><a class="reference internal" href="#module-locations_prob">locations_prob</a></li>
<li><a class="reference internal" href="#module-magnitude">magnitude</a></li>
</ul>
</li>
<li><a class="reference internal" href="#clustering">CLUSTERING</a><ul>
<li><a class="reference internal" href="#module-correlation">correlation</a></li>
<li><a class="reference internal" href="#id1">clustering</a></li>
<li><a class="reference internal" href="#module-double_diff">double_diff</a></li>
<li><a class="reference internal" href="#module-CZ_color">CZ_color</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="getting_started.html"
                        title="previous chapter">Getting Started</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/api.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="getting_started.html" title="Getting Started"
             >previous</a> |</li>
        <li><a href="index.html">waveloc 0.2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Alessia Maggi.
      Last updated on May 26, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>